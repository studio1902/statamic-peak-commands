{{#
    @name Account
    @desc The Account page builder block.
    @set page.page_builder.account
#}}

<!-- /page_builder/_account.antlers.html -->
{{ if !logged_in }}
    {{ redirect to="{ intranet:login_entry | url }" }}
{{ /if }}

{{ user }}
    {{ if !email_verified_at }}
        {{ redirect to="{ intranet:email_verify_entry | url }" }}
    {{ /if }}
{{ /user }}

<div class="fluid-grid gap-y-8">
    {{ user }}
        <section class="span-content grid md:grid-cols-12 gap-8">
            <header class="md:col-span-4">
                {{ partial:typography/prose as="div" }}
                    {{ block:account }}
                {{ /partial:typography/prose }}
            </header>

            <div class="md:col-span-8">
                {{ user:profile_form redirect="#form" error_redirect="#form" id="form" class="grid md:grid-cols-2 gap-6 pt-1.5" }}
                    {{ partial:components/form_input field_handle="first_name" type="text" label="{ trans:strings.account_first_name }" required="true" old_value="{ old:first_name }" value="{ first_name }" }}

                    {{ partial:components/form_input field_handle="last_name" type="text" label="{ trans:strings.account_last_name }" required="true" old_value="{ old:last_name }" value="{ last_name }" }}

                    {{ partial:components/form_input field_handle="email" type="email" label="{ trans:strings.account_email }" required="true" old_value="{ old:email }" value="{ email }" }}

                    {{ if errors }}
                        {{ partial:components/notification type="error" class="md:col-span-2" content="{ errors | list }" }}
                    {{ /if }}

                    {{ if success }}
                        {{ partial:components/notification type="success" class="md:col-span-2" content="{ success }" }}
                    {{ /if }}

                    <div class="md:col-span-2 place-self-end flex items-center gap-6">
                        <button class="text-sm underline" type="reset">{{ trans:strings.account_cancel }}</button>

                        <div class="flex justify-end">
                            {{ partial:components/button as="button" button_type="button" label="{ trans:strings.account_save }" }}
                        </div>
                    </div>
                {{ /user:profile_form }}
            </div>
        </section>

        <section class="span-content grid md:grid-cols-12 gap-8">
            <header class="md:col-span-4">
                {{ partial:typography/prose as="div" }}
                    {{ block:password }}
                {{ /partial:typography/prose }}
            </header>

            <div class="md:col-span-8">
                {{ user:password_form redirect="#form" error_redirect="#form" id="form" class="grid md:grid-cols-2 gap-6 pt-1.5" }}
                    {{ partial:components/form_input field_handle="current_password" type="password" label="{ trans:strings.account_current_password }" required="true" old_value="{ old:current_password }" }}

                    {{ partial:components/form_input field_handle="password" type="password" label="{ trans:strings.account_new_password }" required="true" old_value="{ old:password }" }}

                    {{ partial:components/form_input field_handle="password_confirmation" type="password" label="{ trans:strings.account_new_password_confirmation }" required="true" old_value="{ old:password_confirmation }" }}

                    {{ if errors }}
                        {{ partial:components/notification type="error" class="md:col-span-2" content="{ errors | list }" }}
                    {{ /if }}

                    {{ if success }}
                        {{ partial:components/notification type="success" class="md:col-span-2" content="{ success }" }}
                    {{ /if }}

                    <div class="md:col-span-2 place-self-end flex items-center gap-6">
                        <button class="text-sm underline" type="reset">{{ trans:strings.account_cancel }}</button>

                        <div class="flex justify-end">
                            {{ partial:components/button as="button" button_type="button" label="{ trans:strings.account_password_save }" }}
                        </div>
                    </div>
                {{ /user:password_form }}
            </div>
        </section>

        <section class="span-content flex justify-end">
            <a class="text-sm underline" href="{{ user:logout_url redirect="{ intranet:login_entry | url }" }}" title="{{ trans:strings.account_logout }}" aria-label="{{ trans:strings.account_logout }}">
                <span>{{ trans:strings.account_logout }}</span>
            </a>
        </section>
    {{ /user }}
</div>
<!-- End: /page_builder/_account.antlers.html -->
